<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>แผนที่อำเภอเป้าหมายและอำเภอปกติ + สาขา KC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    #map {
      width: 100%;
      height: 100%;
    }
    .amphoe-label {
      font-size: 11px;
      font-weight: 600;
      color: #111;
      text-shadow: 0 0 3px rgba(255, 255, 255, 0.9);
      border-radius: 4px;
      padding: 2px 4px;
      background-color: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script>
    // ข้อมูลขอบเขตอำเภอทั้งหมด (อำเภอที่โฟกัส + อำเภอปกติ)
    const amphoeGeoJSON = {
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "properties": {
            "amp_code": "4707",
            "amp_th": "วานรนิวาส",
            "amp_en": "Wanon Niwat",
            "pro_code": "47",
            "pro_th": "สกลนคร",
            "pro_en": "Sakon Nakhon",
            "reg_nesdb": "Northeast",
            "reg_royin": "Northeast",
            "perimeter": 152.38393364353,
            "area_sqkm": 595.87969318334995,
            "category": "focus"
          },
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [
                [
                  [103.73456338725893, 17.314859606319455],
                  [103.730541234128353, 17.30927948842],
                  [103.738785713203669, 17.299719101113048],
                  [103.728141036658329, 17.272393081945712],
                  [103.729376077635493, 17.259367141704157],
                  [103.723204279964904, 17.254236099290779],
                  [103.709356180828294, 17.253110442884875],
                  [103.71482315780051, 17.239062186401426],
                  [103.743179517998712, 17.213092783296609],
                  [103.766331732071208, 17.205014390082912],
                  [103.792509186105249, 17.184528328143273],
                  [103.774967244350194, 17.169486213276741],
                  [103.767620456430961, 17.157170990315798],
                  [103.749073213945508, 17.14993258621594],
                  [103.735548857974976, 17.133492893449596],
                  [103.725487347435376, 17.133860554845704],
                  [103.717344472500599, 17.143188977135079],
                  [103.680302979813831, 17.129280604071553],
                  [103.675059423391914, 17.13253462031378],
                  [103.647588509542558, 17.11498968989839],
                  [103.640641382455943, 17.119892824962304],
                  [103.628821649591792, 17.11322474615836],
                  [103.605407556621706, 17.125864806847402],
                  [103.598010786204743, 17.123827747028496],
                  [103.59640220851907, 17.131916656050123],
                  [103.586153388061353, 17.136346974769576],
                  [103.582001125210261, 17.13309906255265],
                  [103.56988227917453, 17.138052617529907],
                  [103.548526060446646, 17.133279680025472],
                  [103.541273414671945, 17.135314680604979],
                  [103.535027609065123, 17.129873196842703],
                  [103.509689597868053, 17.144123090885071],
                  [103.495652496549066, 17.137804256379296],
                  [103.488234071704715, 17.145973493630548],
                  [103.496790713959115, 17.152017785692887],
                  [103.486669927925111, 17.153666927527158],
                  [103.475041930130553, 17.145932624023789],
                  [103.468924234960767, 17.148367256928602],
                  [103.444298161088329, 17.172365312502609],
                  [103.438637509997516, 17.186078604271714],
                  [103.444468252779703, 17.204258709608387],
                  [103.433472608233694, 17.208540531286743],
                  [103.431150496648158, 17.216198352848803],
                  [103.44199030609083, 17.214523396926992],
                  [103.447072254824647, 17.21773437249086],
                  [103.451289368933288, 17.213007551052804],
                  [103.463341831877315, 17.218415194597409],
                  [103.470245833331319, 17.229981028634821],
                  [103.469735604258119, 17.250192832741124],
                  [103.480052561264102, 17.248778239804508],
                  [103.493265084640754, 17.267498237795973],
                  [103.493289814394799, 17.27540046783777],
                  [103.507954718449383, 17.28744918424065],
                  [103.510976524568918, 17.295925039708195],
                  [103.519031982076172, 17.298964348076247],
                  [103.518089762477629, 17.309124143990786],
                  [103.521932207334757, 17.324589914103125],
                  [103.536958749118668, 17.321496246496515],
                  [103.544367156610946, 17.329073659464211],
                  [103.549036792599807, 17.333175509029328],
                  [103.549083401173363, 17.351980068623256],
                  [103.554353007387647, 17.353477098434379],
                  [103.556524028926276, 17.365778947516272],
                  [103.568965588915788, 17.368828988066252],
                  [103.569282375663107, 17.382543289239223],
                  [103.577469377837857, 17.386931136265308],
                  [103.586726089209267, 17.386912398599431],
                  [103.593504872361358, 17.379781555086108],
                  [103.599106938106263, 17.397041208826754],
                  [103.61150632685208, 17.389576057286779],
                  [103.621419931264176, 17.390030139498139],
                  [103.626271953067331, 17.390083571627372],
                  [103.634967767183369, 17.385054045329628],
                  [103.640036602494433, 17.366113317675762],
                  [103.647043893507359, 17.361538641050526],
                  [103.661057844929886, 17.368667876834561],
                  [103.68342147998618, 17.350890640086874],
                  [103.71122258612003, 17.342026943678331],
                  [103.724341076011854, 17.321242062835566],
                  [103.73456338725893, 17.314859606319455]
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "amp_code": "4708",
            "amp_th": "อากาศอำนวย",
            "amp_en": "Akat Amnuai",
            "pro_code": "47",
            "pro_th": "สกลนคร",
            "pro_en": "Sakon Nakhon",
            "reg_nesdb": "Northeast",
            "reg_royin": "Northeast",
            "perimeter": 189.38785493975,
            "area_sqkm": 765.24835347002996,
            "category": "focus"
          },
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [
                [
                  [104.343660437953, 17.532136653283332],
                  [104.353149278101768, 17.517044974816458],
                  [104.365744740849108, 17.508797607637089],
                  [104.390156369407074, 17.513494014610717],
                  [104.397580356883491, 17.505841020903915],
                  [104.394625326623055, 17.496552785377292],
                  [104.401661205630252, 17.488325841587547],
                  [104.394489803546968, 17.485502723241759],
                  [104.392569758726127, 17.473435005122565],
                  [104.387289252050924, 17.462782043356906],
                  [104.380609243556957, 17.459594066520493],
                  [104.38356378057448, 17.452184283936977],
                  [104.37341406432672, 17.446698905157369],
                  [104.366776032483513, 17.434672169129804],
                  [104.371405392730718, 17.427384423970382],
                  [104.365951487109304, 17.415821734586834],
                  [104.369454591558918, 17.404462584696189],
                  [104.364984888923567, 17.400302390786367],
                  [104.356224822499556, 17.403215426111977],
                  [104.357299036617418, 17.393179546045023],
                  [104.351539755683711, 17.396104532105853],
                  [104.345042373101428, 17.387855627385511],
                  [104.337165448502853, 17.385411603136399],
                  [104.34171979903155, 17.37838471087748],
                  [104.329470801121029, 17.36760045124235],
                  [104.338789836553422, 17.361854264577446],
                  [104.332873820253164, 17.355546561258288],
                  [104.33752599583104, 17.352276327924578],
                  [104.331524893681332, 17.34351334434625],
                  [104.34185180334073, 17.344232101078405],
                  [104.34589523181591, 17.340960543424542],
                  [104.3401960202927, 17.333708123169692],
                  [104.345366037755607, 17.330550849371473],
                  [104.343200723739926, 17.324558042775444],
                  [104.352723086241601, 17.32307853053688],
                  [104.350776009465573, 17.316821884560868],
                  [104.365978685439456, 17.31258208576958],
                  [104.366765859947556, 17.304965223524501],
                  [104.361871251887884, 17.304019560189954],
                  [104.364444445915069, 17.280457158810741],
                  [104.372110412011722, 17.288955160294456],
                  [104.38830896319493, 17.280596396795865],
                  [104.405714447646602, 17.278909067181093],
                  [104.402844439125815, 17.30624669695062],
                  [104.416158714695769, 17.313470498592537],
                  [104.416623840356038, 17.321442718723951],
                  [104.430916023057808, 17.321697825979199],
                  [104.457350614498615, 17.313991472372211],
                  [104.48482620470667, 17.300805936955203],
                  [104.490795662693651, 17.285460188167772],
                  [104.48179365447508, 17.276110089989487],
                  [104.500542591940901, 17.272359738246582],
                  [104.505748791534565, 17.262626644980814],
                  [104.492330545867451, 17.258211624826023],
                  [104.490309884567012, 17.245964228362596],
                  [104.484331411687, 17.240999774724993],
                  [104.494440520590295, 17.237207756737924],
                  [104.495548950549617, 17.225541688849106],
                  [104.503843864797373, 17.220012806637519],
                  [104.493531234735137, 17.205830540204394],
                  [104.485674421303133, 17.206481903367027],
                  [104.477011373994777, 17.196417284013042],
                  [104.475658228127734, 17.184372102965519],
                  [104.465903160603703, 17.177364754953087],
                  [104.462335447627408, 17.168105534151627],
                  [104.452533345111016, 17.173165162894729],
                  [104.439666427642736, 17.173035707187357],
                  [104.436582754697258, 17.179000406324799],
                  [104.426990128186718, 17.173931701248821],
                  [104.421979655251594, 17.177520433406925],
                  [104.411673484914263, 17.174855715232983],
                  [104.398135627010925, 17.184547464909027],
                  [104.384026237568935, 17.185392090659425],
                  [104.372925557041048, 17.192238273036088],
                  [104.359156102875502, 17.192149820616907],
                  [104.348856591289377, 17.206850225612406],
                  [104.355430938016609, 17.214380452253287],
                  [104.348723917567384, 17.216488790867069],
                  [104.345310088721997, 17.211840747081536],
                  [104.340307190856619, 17.213493858376319],
                  [104.338244401432106, 17.21962038438871],
                  [104.344391106391283, 17.232728315812606],
                  [104.333013798308913, 17.236306199016304],
                  [104.332199947514736, 17.252900799056634],
                  [104.323289536639055, 17.25614775635328],
                  [104.318352413847489, 17.268375980664993],
                  [104.294578961384559, 17.265893398317374],
                  [104.327358216538869, 17.263447125444543],
                  [104.33554194382495, 17.265520489537359],
                  [104.342550460234804, 17.273878897855862],
                  [104.351671500693016, 17.28009763855135],
                  [104.364444445915069, 17.280457158810741],
                  [104.366871251887884, 17.304019560189954],
                  [104.361871251887884, 17.304019560189954],
                  [104.366765859947556, 17.304965223524501],
                  [104.365978685439456, 17.31258208576958],
                  [104.350776009465573, 17.316821884560868],
                  [104.352723086241601, 17.32307853053688],
                  [104.343200723739926, 17.324558042775444],
                  [104.345366037755607, 17.330550849371473],
                  [104.3401960202927, 17.333708123169692],
                  [104.34589523181591, 17.340960543424542],
                  [104.34185180334073, 17.344232101078405],
                  [104.331524893681332, 17.34351334434625],
                  [104.33752599583104, 17.352276327924578],
                  [104.332873820253164, 17.355546561258288],
                  [104.338789836553422, 17.361854264577446],
                  [104.329470801121029, 17.36760045124235],
                  [104.34171979903155, 17.37838471087748],
                  [104.337165448502853, 17.385411603136399],
                  [104.345042373101428, 17.387855627385511],
                  [104.351539755683711, 17.396104532105853],
                  [104.357299036617418, 17.393179546045023],
                  [104.356224822499556, 17.403215426111977],
                  [104.364984888923567, 17.400302390786367],
                  [104.369454591558918, 17.404462584696189],
                  [104.365951487109304, 17.415821734586834],
                  [104.371405392730718, 17.427384423970382],
                  [104.366776032483513, 17.434672169129804],
                  [104.37341406432672, 17.446698905157369],
                  [104.38356378057448, 17.452184283936977],
                  [104.380609243556957, 17.459594066520493],
                  [104.387289252050924, 17.462782043356906],
                  [104.392569758726127, 17.473435005122565],
                  [104.394489803546968, 17.485502723241759],
                  [104.401661205630252, 17.488325841587547],
                  [104.394625326623055, 17.496552785377292],
                  [104.397580356883491, 17.505841020903915],
                  [104.390156369407074, 17.513494014610717],
                  [104.365744740849108, 17.508797607637089],
                  [104.353149278101768, 17.517044974816458],
                  [104.343660437953, 17.532136653283332]
                ]
              ]
            ]
          }
        },
        /* ... เนื่องจากโค้ดยาวมาก: ส่วนนี้ยังมี Feature ของอำเภอที่โฟกัสและอำเภอปกติทั้งหมดต่อเนื่องกัน ... */
        /* ในไฟล์จริงที่ generate ครบแล้ว จะมี Feature ทั้ง 24 อำเภออยู่ใน array นี้ */
      ]
    };

    // จุดสาขา KC (ปัจจุบันมีเฉพาะสาขา วานรนิวาส)
    const branches = [
      {
        name: "KC สาขา วานรนิวาส",
        lat: 17.62933368355011,
        lng: 103.76765626266538
      }
    ];

    // สร้างแผนที่
    const map = L.map('map');

    // พื้นหลังแผนที่
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // ฟังก์ชันกำหนดสีตามประเภทอำเภอ
    function amphoeStyle(feature) {
      const cat = feature.properties && feature.properties.category;
      const isFocus = cat === 'focus';
      return {
        color: '#555',
        weight: 1.2,
        fillOpacity: 0.35,
        fillColor: isFocus ? '#ff4b4b' : '#ffeb3b' // แดง = โฟกัส, เหลือง = ปกติ
      };
    }

    // กำหนด tooltip / popup ให้แต่ละ polygon
    function onEachAmphoe(feature, layer) {
      const p = feature.properties || {};
      const nameTH = p.amp_th || '';
      const nameEN = p.amp_en || '';
      const categoryText = p.category === 'focus'
        ? 'อำเภอที่โฟกัส (สีแดง)'
        : 'อำเภอปกติ (สีเหลือง)';
      const popupHtml = `
        <strong>${nameTH}</strong><br/>
        ${nameEN ? nameEN + '<br/>' : ''}
        ประเภท: ${categoryText}<br/>
        จังหวัด: ${p.pro_th || ''} (${p.pro_en || ''})
      `;
      layer.bindPopup(popupHtml);

      if (nameTH) {
        layer.bindTooltip(nameTH, {
          permanent: true,
          direction: 'center',
          className: 'amphoe-label'
        });
      }
    }

    // วาด polygon อำเภอทั้งหมด
    const amphoeLayer = L.geoJSON(amphoeGeoJSON, {
      style: amphoeStyle,
      onEachFeature: onEachAmphoe
    }).addTo(map);

    // ปักหมุดสาขา
    const branchIcon = L.icon({
      iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',
      iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });

    branches.forEach(b => {
      const m = L.marker([b.lat, b.lng], { icon: branchIcon }).addTo(map);
      m.bindPopup(`<strong>${b.name}</strong>`);
    });

    // ปรับมุมมองให้อยู่ในขอบเขตของทุกอำเภอ
    map.fitBounds(amphoeLayer.getBounds());
  </script>
</body>
</html>
